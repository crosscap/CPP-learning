see answer in Query.h and QueryTest.cc