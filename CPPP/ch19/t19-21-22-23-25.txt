see answer in Token.cc
