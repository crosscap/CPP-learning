see answer in compare.cc