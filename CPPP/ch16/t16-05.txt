see answer in print.cc